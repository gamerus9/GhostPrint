# SHUI/Marlin 3D Print Manager

Десктопное приложение для управления 3D-печатью на принтерах с прошивкой **SHUI/Marlin** (Flying Bear Ghost 5 и совместимые модели).

![Python](https://img.shields.io/badge/python-3.11%2B-blue)
![Platform](https://img.shields.io/badge/platform-macOS%20%7C%20Windows%20%7C%20Linux-lightgrey)
![License](https://img.shields.io/badge/license-MIT-green)

## Возможности

- **Отправка G-code по Wi-Fi** — загружает файл на принтер одним кликом; можно также сохранить обработанный G-code локально
- **Браузер проектов** — поиск и сортировка (по дате, имени, размеру)
- **Drag & drop** `.gcode` файлов прямо в окно приложения
- **Превью миниатюр** — читает встроенные PNG-превью из OrcaSlicer / PrusaSlicer
- **Статус принтера в реальном времени** — температура и прогресс печати через TCP/Marlin
- **Управление печатью** — пауза, возобновление, остановка прямо из приложения
- **G-code терминал** — ручная отправка команд Marlin, история команд, быстрые кнопки
- **Охлаждение после печати** — вставляет паузу с включённым вентилятором перед `M84`
- **История отправок** — фиксирует каждую загрузку с временной меткой и результатом
- Совместим с любым слайсером (OrcaSlicer, Cura, PrusaSlicer, Simplify3D и др.)

## Требования

- Python 3.11+
- [uv](https://github.com/astral-sh/uv) (рекомендуется) или pip
- Принтер с прошивкой **SHUI/Marlin**, подключённый к той же локальной сети

> **macOS:** полная поддержка.
> **Windows / Linux:** основной функционал работает. Пункты контекстного меню «Открыть в Finder» и «Открыть в OrcaSlicer» используют macOS-команду `open` и на других платформах не сработают.

## Установка

```bash
git clone https://github.com/gamerus9/Shui-Wifi-Manager
cd Shui-Wifi-Manager
```

Явный шаг установки не нужен — зависимости объявлены inline и управляются через `uv`.

## Запуск

```bash
./run.sh
```

Или напрямую:

```bash
uv run app.py
```

Или через системный Python (предварительно установить зависимости):

```bash
pip install Pillow requests tkinterdnd2
python app.py
```

## Настройки

При первом запуске рядом с `app.py` создаётся `settings.json`. Его можно редактировать вручную или через диалог настроек (кнопка ⚙):

| Параметр | По умолчанию | Описание |
|---|---|---|
| `printer_ip` | `192.168.1.213` | IP-адрес принтера |
| `upload_speed_kbs` | `80` | Используется для оценки времени загрузки |
| `default_cooling` | `0` | Охлаждение по умолчанию в диалоге отправки (секунды) |
| `projects_dir` | `projects` | Папка, в которой ищутся `.gcode` файлы |

## Как это работает

Прошивка SHUI/Marlin предоставляет:
- **TCP порт 8080** — текстовый интерфейс команд Marlin (M105 температуры, M27 состояние печати)
- **HTTP `/upload`** — эндпоинт для загрузки файлов (multipart)

Приложение подключается по TCP для опроса статуса каждые 15 секунд и загружает G-code по HTTP. G-code формирует слайсер — приложение только опционально добавляет блок охлаждения перед `M84`.

## Совместимость

Проверено с:
- Flying Bear Ghost 5 (прошивка SHUI)
- OrcaSlicer, UltiMaker Cura, PrusaSlicer

Должно работать с любым принтером на прошивке SHUI/Marlin с аналогичным TCP/HTTP интерфейсом.

## Лицензия

MIT
